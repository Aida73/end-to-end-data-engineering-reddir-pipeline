[2024-04-26T12:44:05.326+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: etl_reddit_pipeline.reddit_extraction manual__2024-04-26T12:44:03.732794+00:00 [queued]>
[2024-04-26T12:44:05.329+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: etl_reddit_pipeline.reddit_extraction manual__2024-04-26T12:44:03.732794+00:00 [queued]>
[2024-04-26T12:44:05.330+0000] {taskinstance.py:1361} INFO - Starting attempt 1 of 1
[2024-04-26T12:44:05.335+0000] {taskinstance.py:1382} INFO - Executing <Task(PythonOperator): reddit_extraction> on 2024-04-26 12:44:03.732794+00:00
[2024-04-26T12:44:05.338+0000] {standard_task_runner.py:57} INFO - Started process 50 to run task
[2024-04-26T12:44:05.346+0000] {standard_task_runner.py:84} INFO - Running: ['airflow', 'tasks', 'run', 'etl_reddit_pipeline', 'reddit_extraction', 'manual__2024-04-26T12:44:03.732794+00:00', '--job-id', '13', '--raw', '--subdir', 'DAGS_FOLDER/reddit_dag.py', '--cfg-path', '/tmp/tmpvrbr1uo_']
[2024-04-26T12:44:05.352+0000] {standard_task_runner.py:85} INFO - Job 13: Subtask reddit_extraction
[2024-04-26T12:44:05.404+0000] {task_command.py:416} INFO - Running <TaskInstance: etl_reddit_pipeline.reddit_extraction manual__2024-04-26T12:44:03.732794+00:00 [running]> on host 1bd1b115cb8b
[2024-04-26T12:44:05.456+0000] {taskinstance.py:1662} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Aida Sow' AIRFLOW_CTX_DAG_ID='etl_reddit_pipeline' AIRFLOW_CTX_TASK_ID='reddit_extraction' AIRFLOW_CTX_EXECUTION_DATE='2024-04-26T12:44:03.732794+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2024-04-26T12:44:03.732794+00:00'
[2024-04-26T12:44:05.627+0000] {logging_mixin.py:151} INFO - connected to reddit!
[2024-04-26T12:44:06.687+0000] {logging_mixin.py:151} INFO - {'comment_limit': 2048, 'comment_sort': 'confidence', '_reddit': <praw.reddit.Reddit object at 0xffff77397400>, 'approved_at_utc': None, 'subreddit': Subreddit(display_name='dataengineering'), 'selftext': 'I currently work at a large firm with a very large sap erp enterprise instance. Over the past two years, I\'ve encountered more issues with SAP product teams and consultants than with any technology in my entire career prior. \n\n SAP is such a shitty company; it\'s just disgusting. Lately, they disallowed the use of ODP RFC replication services, which basically outlawed any integration tool that uses this method to replicate SAP data to the cloud, e.g., Qlik, Azure Data Factory, Talend, and many more. \n\nIt’s no coincidence that this change coincided with the launch of their "new" rebranded data warehouse, Data Sphere, where the costs of moving data into cloud services are exorbitant. Additionally, they\'ve deliberately limited access to Data Sphere via their oData API for replication services. \n\nI know this is basically a rant but the amount of bullshit is just baffling. How do you guys deal with the SAP virus and what its your funny story?', 'author_fullname': 't2_793tedn0', 'saved': False, 'mod_reason_title': None, 'gilded': 0, 'clicked': False, 'title': 'Whats your horror story with SAP Integration?', 'link_flair_richtext': [], 'subreddit_name_prefixed': 'r/dataengineering', 'hidden': False, 'pwls': 6, 'link_flair_css_class': '', 'downs': 0, 'thumbnail_height': None, 'top_awarded_type': None, 'hide_score': False, 'name': 't3_1ccv2r3', 'quarantine': False, 'link_flair_text_color': 'light', 'upvote_ratio': 0.97, 'author_flair_background_color': None, 'subreddit_type': 'public', 'ups': 119, 'total_awards_received': 0, 'media_embed': {}, 'thumbnail_width': None, 'author_flair_template_id': None, 'is_original_content': False, 'user_reports': [], 'secure_media': None, 'is_reddit_media_domain': False, 'is_meta': False, 'category': None, 'secure_media_embed': {}, 'link_flair_text': 'Discussion', 'can_mod_post': False, 'score': 119, 'approved_by': None, 'is_created_from_ads_ui': False, 'author_premium': False, 'thumbnail': 'self', 'edited': False, 'author_flair_css_class': None, 'author_flair_richtext': [], 'gildings': {}, 'content_categories': None, 'is_self': True, 'mod_note': None, 'created': 1714059468.0, 'link_flair_type': 'text', 'wls': 6, 'removed_by_category': None, 'banned_by': None, 'author_flair_type': 'text', 'domain': 'self.dataengineering', 'allow_live_comments': False, 'selftext_html': '<!-- SC_OFF --><div class="md"><p>I currently work at a large firm with a very large sap erp enterprise instance. Over the past two years, I&#39;ve encountered more issues with SAP product teams and consultants than with any technology in my entire career prior. </p>\n\n<p>SAP is such a shitty company; it&#39;s just disgusting. Lately, they disallowed the use of ODP RFC replication services, which basically outlawed any integration tool that uses this method to replicate SAP data to the cloud, e.g., Qlik, Azure Data Factory, Talend, and many more. </p>\n\n<p>It’s no coincidence that this change coincided with the launch of their &quot;new&quot; rebranded data warehouse, Data Sphere, where the costs of moving data into cloud services are exorbitant. Additionally, they&#39;ve deliberately limited access to Data Sphere via their oData API for replication services. </p>\n\n<p>I know this is basically a rant but the amount of bullshit is just baffling. How do you guys deal with the SAP virus and what its your funny story?</p>\n</div><!-- SC_ON -->', 'likes': None, 'suggested_sort': None, 'banned_at_utc': None, 'view_count': None, 'archived': False, 'no_follow': False, 'is_crosspostable': False, 'pinned': False, 'over_18': False, 'all_awardings': [], 'awarders': [], 'media_only': False, 'link_flair_template_id': '92b74b58-aaca-11eb-b160-0e6181e3773f', 'can_gild': False, 'spoiler': False, 'locked': False, 'author_flair_text': None, 'treatment_tags': [], 'visited': False, 'removed_by': None, 'num_reports': None, 'distinguished': None, 'subreddit_id': 't5_36en4', 'author_is_blocked': False, 'mod_reason_by': None, 'removal_reason': None, 'link_flair_background_color': '#ff4500', 'id': '1ccv2r3', 'is_robot_indexable': True, 'report_reasons': None, 'author': Redditor(name='Ok-Sentence-8542'), 'discussion_type': None, 'num_comments': 74, 'send_replies': True, 'whitelist_status': 'all_ads', 'contest_mode': False, 'mod_reports': [], 'author_patreon_flair': False, 'author_flair_text_color': None, 'permalink': '/r/dataengineering/comments/1ccv2r3/whats_your_horror_story_with_sap_integration/', 'parent_whitelist_status': 'all_ads', 'stickied': False, 'url': 'https://www.reddit.com/r/dataengineering/comments/1ccv2r3/whats_your_horror_story_with_sap_integration/', 'subreddit_subscribers': 179074, 'created_utc': 1714059468.0, 'num_crossposts': 0, 'media': None, 'is_video': False, '_fetched': False, '_additional_fetch_params': {}, '_comments_by_id': {}}
[2024-04-26T12:44:06.689+0000] {taskinstance.py:1937} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/operators/python.py", line 192, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/operators/python.py", line 209, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/pipelines/reddit_pipeline.py", line 9, in reddit_pipeline
    posts = extract_posts(instance, subreddit, time_filter, limit)
  File "/opt/airflow/etls/reddit_etl.py", line 29, in extract_posts
    post = {key: post_dict[key] for key in POSTS_FIELDS}
NameError: name 'POSTS_FIELDS' is not defined
[2024-04-26T12:44:06.710+0000] {taskinstance.py:1400} INFO - Marking task as FAILED. dag_id=etl_reddit_pipeline, task_id=reddit_extraction, execution_date=20240426T124403, start_date=20240426T124405, end_date=20240426T124406
[2024-04-26T12:44:06.720+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 13 for task reddit_extraction (name 'POSTS_FIELDS' is not defined; 50)
[2024-04-26T12:44:06.731+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2024-04-26T12:44:06.744+0000] {taskinstance.py:2778} INFO - 0 downstream tasks scheduled from follow-on schedule check
